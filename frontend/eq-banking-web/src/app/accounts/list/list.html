<div class="page">

  <!-- Header -->
  <header class="page-header">
    <div>
      <h1>MJ Banking – Accounts</h1>
      <p class="page-subtitle">
        Monitor balances, statuses and quickly simulate common account operations.
      </p>
    </div>

    <div *ngIf="accounts.length > 0" class="status-pill">
      {{ accounts.length }} account{{ accounts.length === 1 ? '' : 's' }} total
    </div>
  </header>

  <div class="layout">

    <!-- LEFT: CREATE ACCOUNT CARD -->
    <section class="card card-form">
      <h2>Create account</h2>

      <div class="form-grid">
        <div class="field">
          <span>Name</span>
          <input
            type="text"
            [(ngModel)]="ownerName"
            placeholder="Alex Martin" />
        </div>

        <div class="field">
          <span>Email</span>
          <input
            type="email"
            [(ngModel)]="ownerEmail"
            placeholder="alex@example.com" />
        </div>

        <div class="field">
          <span>Initial balance</span>
          <input
            type="number"
            [(ngModel)]="initialBalance"
            placeholder="1000" />
        </div>

        <div class="field">
          <span>Currency</span>
          <input
            type="text"
            class="currency-input"
            [(ngModel)]="currency"
            maxlength="3"
            placeholder="CAD" />
        </div>
      </div>

      <div class="actions">
        <button class="btn btn-primary" (click)="createAccount()">
          Create account
        </button>
      </div>

      <p class="helper-text">
        Validation is enforced on the backend – invalid data will return detailed messages.
      </p>
    </section>

    <!-- RIGHT: ACCOUNTS TABLE CARD -->
    <section class="card card-table">
      <div class="card-header">
        <h2>All accounts</h2>
      </div>

      <!-- Error banner -->
      <div *ngIf="error" class="alert alert-error">
        {{ error }}
      </div>

      <!-- Loading state -->
      <div *ngIf="loading" class="loading">
        Loading accounts…
      </div>

      <!-- Empty state -->
      <div *ngIf="!loading && accounts.length === 0" class="empty-state">
        <p>No accounts yet.</p>
        <p class="empty-hint">
          Use the form on the left to create the first one.
        </p>
      </div>

      <!-- Table -->
      <div *ngIf="accounts.length > 0" class="table-wrapper">
        <table>
          <thead>
          <tr>
            <th>ID</th>
            <th>Account #</th>
            <th>Owner</th>
            <th>Email</th>
            <th>Balance</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
          </thead>

          <tbody>
          <tr *ngFor="let acc of accounts">
            <td>{{ acc.id }}</td>

            <td class="mono">
              {{ acc.accountNumber }}
            </td>

            <td>{{ acc.ownerName }}</td>

            <td class="email-cell">
              {{ acc.ownerEmail }}
            </td>

            <td>
                <span
                  class="balance"
                  [class.negative]="acc.balance < 0">
                  {{ acc.balance | number:'1.2-2' }}
                </span>
              &nbsp;{{ acc.currency }}
            </td>

            <td>
                <span
                  class="status"
                  [class.status-active]="acc.status === 'ACTIVE'"
                  [class.status-frozen]="acc.status === 'FROZEN'"
                  [class.status-closed]="acc.status === 'CLOSED'">
                  {{ acc.status }}
                </span>
            </td>

            <td>
              <div class="btn-row">
                <button class="btn btn-small btn-outline"
                        (click)="quickDeposit(acc)">
                  +100
                </button>

                <button class="btn btn-small btn-outline"
                        (click)="quickWithdraw(acc)">
                  -50
                </button>

                <button
                  class="btn btn-small btn-outline"
                  *ngIf="acc.status === 'ACTIVE'"
                  (click)="freeze(acc)">
                  Freeze
                </button>

                <button
                  class="btn btn-small btn-outline"
                  *ngIf="acc.status === 'FROZEN'"
                  (click)="unfreeze(acc)">
                  Unfreeze
                </button>

                <button
                  class="btn btn-small btn-danger"
                  *ngIf="acc.status !== 'CLOSED'"
                  (click)="close(acc)">
                  Close
                </button>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </section>

  </div>
</div>
